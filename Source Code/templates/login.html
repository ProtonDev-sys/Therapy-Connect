{% extends "topbar.html" %}
{% block content %}

<!DOCTYPE html>
<html>
  <head>
    <title>Sign Up</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/login.css') }}">
  </head>
  <body>
    <div class="header">
        <h1>Login</h1>
    </div>
    <form id = "login-form">
      <label for="username">Username:</label>
      <input type="text" id="username" name="username"><br>
      <label for="password">Password:</label>
      <input type="password" id="password" name="password"><br>
      
      <input type="submit" value="Login">
    </form>
    <p id="login-error"></p>
  <script>
    const loginForm = document.getElementById("login-form");
    const errorElement = document.getElementById("login-error");

    loginForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        const response = await fetch("/login", {
            method: "POST",
            body: formData,
        });
        // try catch to prevent json error 

        const data = await response.json();
        if (data.ERROR) {
            // if response contains an "error" in JSON, display the error
            errorElement.textContent = data.ERROR
        } else {
            // if response doesn't contain an error, redirect user to their profile page
            window.location.href = "/profile";
        }
    });
  </script>
{% endblock %}
